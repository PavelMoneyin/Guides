#########PLEASE NOTE, THIS IS NOT OFFICIAL GUIDE AND WILL BE AVAILABLE FOR LINUX/UBUNTU 20.04. FOR GITOPIA VERSION v0.13.0#########
#########PLEASE VISIT OFFICIAL DOCS https://docs.gitopia.com/ AND https://gitopia.com/gitopia1dlpc7ps63kj5v0kn5v8eq9sn2n8v8r5z9jmwff FOR LATEST NEWS#########

# Server preparation
sudo apt update && sudo apt upgrade -y
sudo apt install make clang pkg-config libssl-dev libclang-dev build-essential git curl ntp jq llvm tmux htop screen gcc
sudo apt-get install -y make gcc

# Install GO 1.18
wget https://golang.org/dl/go1.18.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.18.linux-amd64.tar.gz
cat <<EOF >> ~/.profile
export GOROOT=/usr/local/go
export GOPATH=$HOME/go
export GO111MODULE=on
export PATH=$PATH:/usr/local/go/bin:$HOME/go/bin
EOF
source ~/.profile
go version
# Go version should be "go version go1.18 linux/amd64"

# Setting up a Gitopia Node
curl https://get.gitopia.com | bash
git clone -b v0.13.0 gitopia://gitopia1dlpc7ps63kj5v0kn5v8eq9sn2n8v8r5z9jmwff/gitopia
cd gitopia && make install
git clone gitopia://gitopia1dlpc7ps63kj5v0kn5v8eq9sn2n8v8r5z9jmwff/testnets
cd
GITOPIA_MONIKER="<YOUR-MONIKER>"
gitopiad init --chain-id "$GITOPIA_CHAIN_ID" "$GITOPIA_MONIKER"
cp gitopia/testnets/gitopia-janus-testnet/genesis.json .gitopia/config/
gitopiad validate-genesis

#Creating systemd file
nano /etc/systemd/system/gitopiad.service

#Copy and past all info below
[Unit]
Description=gitopia
After=network-online.target

[Service]
User=root
ExecStart=/root/go/bin/gitopiad start
Restart=always
RestartSec=3
LimitNOFILE=10000

[Install]
WantedBy=multi-user.target

#Save file by "CTRL+X,Y,ENTER

#Launch systemd file
systemctl daemon-reload
systemctl start gitopiad
systemctl enable gitopiad
journalctl -u gitopiad -f
#to exit from journalctl press CTRL+C
